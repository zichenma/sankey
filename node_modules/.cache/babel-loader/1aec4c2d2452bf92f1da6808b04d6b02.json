{"ast":null,"code":"import _classCallCheck from \"/home/voluteuser2/Desktop/react-d3-particle/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/voluteuser2/Desktop/react-d3-particle/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/voluteuser2/Desktop/react-d3-particle/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/voluteuser2/Desktop/react-d3-particle/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/voluteuser2/Desktop/react-d3-particle/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/voluteuser2/Desktop/react-d3-particle/src/particle/SandkeyGraph.js\";\nimport React, { Component, PropTypes } from 'react';\nimport * as d3 from \"d3\";\nimport sankeyModule from \"./sankey\";\nimport styles from './sankey.css';\n\nvar SankeyGraph =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(SankeyGraph, _Component);\n\n  function SankeyGraph(props) {\n    var _this;\n\n    _classCallCheck(this, SankeyGraph);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SankeyGraph).call(this, props));\n    _this.state = {\n      importedData: null\n    };\n    _this.state.importedData = props.sankeyData || null;\n    return _this;\n  }\n\n  _createClass(SankeyGraph, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      console.log(this.state.importedData);\n      this.setContext();\n    }\n  }, {\n    key: \"setContext\",\n    value: function setContext() {\n      var units = \"Widgets\";\n      var _this$props = this.props,\n          height = _this$props.height,\n          width = _this$props.width,\n          id = _this$props.id;\n      var margin = {\n        top: 100,\n        right: 100,\n        bottom: 100,\n        left: 100\n      };\n      var graph = this.state.importedData; // format variables\n\n      var formatNumber = d3.format(\",.0f\"),\n          // zero decimal places\n      format = function format(d) {\n        return formatNumber(d) + \" \" + units;\n      },\n          color = d3.scaleOrdinal(d3.schemeCategory20);\n\n      var svg = d3.select(this.refs.sankey).append('svg').attr(\"width\", width + margin.left + margin.right).attr(\"height\", height + margin.top + margin.bottom).attr('id', id).append('g').attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\"); // Set the sankey diagram properties\n\n      var sankey = sankeyModule(d3).nodeWidth(36).nodePadding(40).size([width, height]);\n      var path = sankey.link();\n      sankey.nodes(graph.nodes).links(graph.links).layout(32);\n      var link = svg.append(\"g\").selectAll(\".link\").data(graph.links).enter().append(\"path\").attr(\"class\", \"link\").attr(\"d\", path).style(\"stroke-width\", function (d) {\n        return Math.max(1, d.dy);\n      }).sort(function (a, b) {\n        return b.dy - a.dy;\n      });\n      link.append(\"title\").text(function (d) {\n        return d.source.name + \" → \" + d.target.name + \"\\n\" + format(d.value);\n      });\n      var node = svg.append(\"g\").selectAll(\".node\").data(graph.nodes).enter().append(\"g\").attr(\"class\", \"node\").attr(\"transform\", function (d) {\n        return \"translate(\" + d.x + \",\" + d.y + \")\";\n      }).call(d3.drag().subject(function (d) {\n        return d;\n      }).on(\"start\", function () {\n        this.parentNode.appendChild(this);\n      }).on(\"drag\", dragmove));\n      node.append(\"rect\").attr(\"height\", function (d) {\n        return d.dy;\n      }).attr(\"width\", sankey.nodeWidth()).style(\"fill\", function (d) {\n        return d.color = color(d.name.replace(/ .*/, \"\"));\n      }).style(\"stroke\", function (d) {\n        return d3.rgb(d.color).darker(2);\n      }).append(\"title\").text(function (d) {\n        return d.name + \"\\n\" + format(d.value);\n      });\n      node.append(\"text\").attr(\"x\", -6).attr(\"y\", function (d) {\n        return d.dy / 2;\n      }).attr(\"dy\", \".35em\").attr(\"text-anchor\", \"end\").attr(\"transform\", null).text(function (d) {\n        return d.name;\n      }).filter(function (d) {\n        return d.x < width / 2;\n      }).attr(\"x\", 6 + sankey.nodeWidth()).attr(\"text-anchor\", \"start\");\n\n      function dragmove(d) {\n        d3.select(this).attr(\"transform\", \"translate(\" + d.x + \",\" + (d.y = Math.max(0, Math.min(height - d.dy, d3.event.y))) + \")\");\n        sankey.relayout();\n        link.attr(\"d\", path);\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var importedData = this.state.importedData;\n\n      if (!importedData) {\n        return null;\n      }\n\n      return React.createElement(\"div\", {\n        ref: \"sankey\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132\n        },\n        __self: this\n      });\n    }\n  }]);\n\n  return SankeyGraph;\n}(Component);\n\nexport default SankeyGraph;","map":{"version":3,"sources":["/home/voluteuser2/Desktop/react-d3-particle/src/particle/SandkeyGraph.js"],"names":["React","Component","PropTypes","d3","sankeyModule","styles","SankeyGraph","props","state","importedData","sankeyData","console","log","setContext","units","height","width","id","margin","top","right","bottom","left","graph","formatNumber","format","d","color","scaleOrdinal","schemeCategory20","svg","select","refs","sankey","append","attr","nodeWidth","nodePadding","size","path","link","nodes","links","layout","selectAll","data","enter","style","Math","max","dy","sort","a","b","text","source","name","target","value","node","x","y","call","drag","subject","on","parentNode","appendChild","dragmove","replace","rgb","darker","filter","min","event","relayout"],"mappings":"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","sourcesContent":["import React, { Component, PropTypes } from 'react';\r\nimport * as d3 from \"d3\";\r\nimport sankeyModule from \"./sankey\"\r\nimport styles from './sankey.css';\r\n\r\nclass SankeyGraph extends Component {\r\n  displayName: 'SankeyGraph';\r\n  \r\n  state = {\r\n    importedData : null\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.state.importedData = props.sankeyData || null;\r\n  }\r\n  \r\n  PropTypes : {\r\n    id : PropTypes.string,\r\n    height: PropTypes.number,\r\n    width: PropTypes.number,\r\n    sankeyData : PropTypes.object,\r\n  }\r\n\r\n \r\n  componentDidMount () {\r\n    console.log(this.state.importedData);\r\n    this.setContext();\r\n  }\r\n\r\n \r\n  setContext() {\r\n    let units = \"Widgets\";\r\n    const { height, width, id} = this.props;\r\n    const margin = {top: 100, right: 100, bottom: 100, left: 100};\r\n    let graph = this.state.importedData;\r\n    \r\n    // format variables\r\n    let formatNumber = d3.format(\",.0f\"),    // zero decimal places\r\n    format = function(d) { return formatNumber(d) + \" \" + units; },\r\n    color = d3.scaleOrdinal(d3.schemeCategory20);\r\n    let svg = d3.select(this.refs.sankey).append('svg')\r\n                .attr(\"width\", width + margin.left + margin.right)\r\n                .attr(\"height\", height + margin.top + margin.bottom)\r\n                .attr('id', id)\r\n                .append('g')\r\n                .attr(\"transform\", \r\n                    \"translate(\" + margin.left + \",\" + margin.top + \")\");\r\n\r\n    // Set the sankey diagram properties\r\n    let sankey = sankeyModule(d3)\r\n                  .nodeWidth(36)\r\n                  .nodePadding(40)\r\n                  .size([width, height]);\r\n    \r\n    let path = sankey.link();\r\n\r\n    sankey\r\n      .nodes(graph.nodes)\r\n      .links(graph.links)\r\n      .layout(32);\r\n\r\n    let link = svg.append(\"g\").selectAll(\".link\")\r\n      .data(graph.links)\r\n      .enter().append(\"path\")\r\n      .attr(\"class\", \"link\")\r\n      .attr(\"d\", path)\r\n      .style(\"stroke-width\", function(d) { return Math.max(1, d.dy); })\r\n      .sort(function(a, b) { return b.dy - a.dy; });\r\n\r\n      link.append(\"title\")\r\n        .text(function(d) {\r\n    \t\treturn d.source.name + \" → \" + \r\n                d.target.name + \"\\n\" + format(d.value); });\r\n      \r\n      let node = svg.append(\"g\").selectAll(\".node\")\r\n          .data(graph.nodes)\r\n          .enter().append(\"g\")\r\n          .attr(\"class\", \"node\")\r\n          .attr(\"transform\", function(d) { \r\n          return \"translate(\" + d.x + \",\" + d.y + \")\"; })\r\n          .call(d3.drag()\r\n          .subject(function(d) {\r\n              return d;\r\n            })\r\n          .on(\"start\", function() {\r\n              this.parentNode.appendChild(this);\r\n            })\r\n          .on(\"drag\", dragmove));\r\n\r\n        node.append(\"rect\")\r\n        .attr(\"height\", function(d) { return d.dy; })\r\n        .attr(\"width\", sankey.nodeWidth())\r\n        .style(\"fill\", function(d) { \r\n        return d.color = color(d.name.replace(/ .*/, \"\")); })\r\n        .style(\"stroke\", function(d) { \r\n        return d3.rgb(d.color).darker(2); })\r\n        .append(\"title\")\r\n        .text(function(d) { \r\n        return d.name + \"\\n\" + format(d.value); });\r\n\r\n        node.append(\"text\")\r\n        .attr(\"x\", -6)\r\n        .attr(\"y\", function(d) { return d.dy / 2; })\r\n        .attr(\"dy\", \".35em\")\r\n        .attr(\"text-anchor\", \"end\")\r\n        .attr(\"transform\", null)\r\n        .text(function(d) { return d.name; })\r\n        .filter(function(d) { return d.x < width / 2; })\r\n        .attr(\"x\", 6 + sankey.nodeWidth())\r\n        .attr(\"text-anchor\", \"start\");\r\n        \r\n        function dragmove(d) {\r\n          d3.select(this)\r\n            .attr(\"transform\", \r\n                  \"translate(\" \r\n                     + d.x + \",\" \r\n                     + (d.y = Math.max(\r\n                        0, Math.min(height - d.dy, d3.event.y))\r\n                       ) + \")\");\r\n          sankey.relayout();\r\n          link.attr(\"d\", path);\r\n        }\r\n  }\r\n\r\n  render() {\r\n    const { importedData } = this.state;\r\n    if (!importedData) {\r\n      return null;\r\n    }\r\n    return (\r\n      <div ref=\"sankey\"></div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default SankeyGraph;"]},"metadata":{},"sourceType":"module"}